{"title":"G. Song of the Sirens","contestId":"1466","problemIndex":"G","timeLimit":"2 seconds","memLimit":"256 megabytes","inputFormat":"standard input","outputFormat":"standard output","problemHtml":"<div class=\"epigraph\"><div class=\"epigraph-text\"> <span class=\"tex-font-style-it\">Whoso in ignorance draws near to them and hears the Sirens&apos; voice, he nevermore returns.</span><p>Homer, <span class=\"tex-font-style-it\">Odyssey</span></p></div></div><p>In the times of Jason and the Argonauts, it was well known that sirens use the sound of their songs to lure sailors into their demise. Yet only a few knew that every time sirens call a sailor by his name, his will weakens, making him more vulnerable. </p><p>For the purpose of this problem, both siren songs and names of the sailors will be represented as strings of lowercase English letters. The more times the sailor&apos;s name occurs as a contiguous substring of the song, the greater danger he is in.</p><p>Jason found out that sirens can sing one of the $$$n+1$$$ songs, which have the following structure: let $$$s_i$$$ ($$$0 \\leq i \\leq n$$$) be the $$$i$$$-th song and $$$t$$$ be a string of length $$$n$$$, then for every $$$i &lt; n$$$: $$$s_{i+1} = s_i t_i s_i$$$. In other words $$$i+1$$$-st song is the concatenation of $$$i$$$-th song, $$$i$$$-th letter ($$$0$$$-indexed) of $$$t$$$ and the $$$i$$$-th song. </p><p>Fortunately, he also knows $$$s_0$$$ and $$$t$$$. Jason wonders how many times a sailor&apos;s name is mentioned in a particular song. Answer $$$q$$$ queries: given the sailor&apos;s name ($$$w$$$) and the index of a song ($$$i$$$) output the number of occurrences of $$$w$$$ in $$$s_i$$$ as a substring. As this number can be quite large, output its remainder modulo $$$10^9+7$$$.</p>","inSpecsHtml":"<div class=\"section-title\">Input</div><p>In the first line of input there are two integers $$$n$$$, $$$q$$$ ( $$$ 1 \\leq n, q \\leq 10^5$$$) meaning that there are $$$n+1$$$ songs and $$$q$$$ queries. In the next two lines strings $$$s_0$$$ and $$$t$$$ follow ($$$1 \\leq |s_0| \\leq 100, |t| = n$$$). </p><p>Next $$$q$$$ lines describe the queries; each one contains an integer $$$k$$$ ($$$ 0 \\leq k \\leq n$$$), the index of the song sung by the sirens, and a non-empty string $$$w$$$, which is the name of a sailor. All strings in this problem consist only of lowercase English letters, and the sum of lengths of sailors&apos; names does not exceed $$$10^6$$$.</p>","outSpecsHtml":"<div class=\"section-title\">Output</div><p>Output $$$q$$$ lines, $$$i$$$-th of them should contain the remainder modulo $$$10^9+7$$$ of the number of occurrences of $$$w$$$ in $$$s_k$$$.</p>","noteHtml":"<div class=\"section-title\">Note</div><p>In the first example songs of the sirens are as follows: </p><ul> <li> Song $$$0$$$: <span class=\"tex-font-style-tt\">aa</span> </li><li> Song $$$1$$$: <span class=\"tex-font-style-tt\">aabaa</span> </li><li> Song $$$2$$$: <span class=\"tex-font-style-tt\">aabaacaabaa</span> </li><li> Song $$$3$$$: <span class=\"tex-font-style-tt\">aabaacaabaadaabaacaabaa</span> </li></ul>","sampleTestcases":[{"id":1612201150984,"input":"3 3\naa\nbcd\n2 aba\n3 ca\n3 aa\n","output":"2\n2\n8\n"},{"id":1612201150985,"input":"4 5\naba\nbbac\n1 a\n3 baca\n3 ab\n2 bab\n4 aba\n","output":"4\n0\n14\n6\n28\n"}],"submitUrl":"https://codeforces.com/contest/1466/submit","language":"c++"}
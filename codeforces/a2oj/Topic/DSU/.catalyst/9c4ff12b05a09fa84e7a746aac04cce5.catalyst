{"title":"B. New Year Permutation","contestId":"500","problemIndex":"B","timeLimit":"2 seconds","memLimit":"256 megabytes","inputFormat":"standard input","outputFormat":"standard output","problemHtml":"<p>User ainta has a permutation <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\">1</sub>,&#x2009;<i>p</i><sub class=\"lower-index\">2</sub>,&#x2009;...,&#x2009;<i>p</i><sub class=\"lower-index\"><i>n</i></sub></span>. As the New Year is coming, he wants to make his permutation as pretty as possible.</p><p>Permutation <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\">1</sub>,&#x2009;<i>a</i><sub class=\"lower-index\">2</sub>,&#x2009;...,&#x2009;<i>a</i><sub class=\"lower-index\"><i>n</i></sub></span> is <span class=\"tex-font-style-it\">prettier</span> than permutation <span class=\"tex-span\"><i>b</i><sub class=\"lower-index\">1</sub>,&#x2009;<i>b</i><sub class=\"lower-index\">2</sub>,&#x2009;...,&#x2009;<i>b</i><sub class=\"lower-index\"><i>n</i></sub></span>, if and only if there exists an integer <span class=\"tex-span\"><i>k</i></span> (<span class=\"tex-span\">1&#x2009;&#x2264;&#x2009;<i>k</i>&#x2009;&#x2264;&#x2009;<i>n</i></span>) where <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\">1</sub>&#x2009;=&#x2009;<i>b</i><sub class=\"lower-index\">1</sub>,&#x2009;<i>a</i><sub class=\"lower-index\">2</sub>&#x2009;=&#x2009;<i>b</i><sub class=\"lower-index\">2</sub>,&#x2009;...,&#x2009;<i>a</i><sub class=\"lower-index\"><i>k</i>&#x2009;-&#x2009;1</sub>&#x2009;=&#x2009;<i>b</i><sub class=\"lower-index\"><i>k</i>&#x2009;-&#x2009;1</sub></span> and <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>k</i></sub>&#x2009;&lt;&#x2009;<i>b</i><sub class=\"lower-index\"><i>k</i></sub></span> all holds.</p><p>As known, permutation <span class=\"tex-span\"><i>p</i></span> is so sensitive that it could be only modified by swapping two distinct elements. But swapping two elements is harder than you think. Given an <span class=\"tex-span\"><i>n</i>&#x2009;&#xD7;&#x2009;<i>n</i></span> binary matrix <span class=\"tex-span\"><i>A</i></span>, user ainta can swap the values of <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>j</i></sub></span> (<span class=\"tex-span\">1&#x2009;&#x2264;&#x2009;<i>i</i>,&#x2009;<i>j</i>&#x2009;&#x2264;&#x2009;<i>n</i></span>, <span class=\"tex-span\"><i>i</i>&#x2009;&#x2260;&#x2009;<i>j</i></span>) if and only if <span class=\"tex-span\"><i>A</i><sub class=\"lower-index\"><i>i</i>,&#x2009;<i>j</i></sub>&#x2009;=&#x2009;1</span>.</p><p>Given the permutation <span class=\"tex-span\"><i>p</i></span> and the matrix <span class=\"tex-span\"><i>A</i></span>, user ainta wants to know the prettiest permutation that he can obtain.</p>","inSpecsHtml":"<div class=\"section-title\">Input</div><p>The first line contains an integer <span class=\"tex-span\"><i>n</i></span> (<span class=\"tex-span\">1&#x2009;&#x2264;&#x2009;<i>n</i>&#x2009;&#x2264;&#x2009;300</span>) &#x2014; the size of the permutation <span class=\"tex-span\"><i>p</i></span>.</p><p>The second line contains <span class=\"tex-span\"><i>n</i></span> space-separated integers <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\">1</sub>,&#x2009;<i>p</i><sub class=\"lower-index\">2</sub>,&#x2009;...,&#x2009;<i>p</i><sub class=\"lower-index\"><i>n</i></sub></span> &#x2014; the permutation <span class=\"tex-span\"><i>p</i></span> that user ainta has. Each integer between <span class=\"tex-span\">1</span> and <span class=\"tex-span\"><i>n</i></span> occurs exactly once in the given permutation.</p><p>Next <span class=\"tex-span\"><i>n</i></span> lines describe the matrix <span class=\"tex-span\"><i>A</i></span>. The <span class=\"tex-span\"><i>i</i></span>-th line contains <span class=\"tex-span\"><i>n</i></span> characters &apos;<span class=\"tex-font-style-tt\">0</span>&apos; or &apos;<span class=\"tex-font-style-tt\">1</span>&apos; and describes the <span class=\"tex-span\"><i>i</i></span>-th row of <span class=\"tex-span\"><i>A</i></span>. The <span class=\"tex-span\"><i>j</i></span>-th character of the <span class=\"tex-span\"><i>i</i></span>-th line <span class=\"tex-span\"><i>A</i><sub class=\"lower-index\"><i>i</i>,&#x2009;<i>j</i></sub></span> is the element on the intersection of the <span class=\"tex-span\"><i>i</i></span>-th row and the <span class=\"tex-span\"><i>j</i></span>-th column of A. It is guaranteed that, for all integers <span class=\"tex-span\"><i>i</i>,&#x2009;<i>j</i></span> where <span class=\"tex-span\">1&#x2009;&#x2264;&#x2009;<i>i</i>&#x2009;&lt;&#x2009;<i>j</i>&#x2009;&#x2264;&#x2009;<i>n</i></span>, <span class=\"tex-span\"><i>A</i><sub class=\"lower-index\"><i>i</i>,&#x2009;<i>j</i></sub>&#x2009;=&#x2009;<i>A</i><sub class=\"lower-index\"><i>j</i>,&#x2009;<i>i</i></sub></span> holds. Also, for all integers <span class=\"tex-span\"><i>i</i></span> where <span class=\"tex-span\">1&#x2009;&#x2264;&#x2009;<i>i</i>&#x2009;&#x2264;&#x2009;<i>n</i></span>, <span class=\"tex-span\"><i>A</i><sub class=\"lower-index\"><i>i</i>,&#x2009;<i>i</i></sub>&#x2009;=&#x2009;0</span> holds.</p>","outSpecsHtml":"<div class=\"section-title\">Output</div><p>In the first and only line, print <span class=\"tex-span\"><i>n</i></span> space-separated integers, describing the prettiest permutation that can be obtained.</p>","noteHtml":"<div class=\"section-title\">Note</div><p>In the first sample, the swap needed to obtain the prettiest permutation is: <span class=\"tex-span\">(<i>p</i><sub class=\"lower-index\">1</sub>,&#x2009;<i>p</i><sub class=\"lower-index\">7</sub>)</span>.</p><p>In the second sample, the swaps needed to obtain the prettiest permutation is <span class=\"tex-span\">(<i>p</i><sub class=\"lower-index\">1</sub>,&#x2009;<i>p</i><sub class=\"lower-index\">3</sub>),&#x2009;(<i>p</i><sub class=\"lower-index\">4</sub>,&#x2009;<i>p</i><sub class=\"lower-index\">5</sub>),&#x2009;(<i>p</i><sub class=\"lower-index\">3</sub>,&#x2009;<i>p</i><sub class=\"lower-index\">4</sub>)</span>. </p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/5f8e6bda24d0cad777a5830c2f665beb5377ce8e.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"> </center><p>A <span class=\"tex-font-style-bf\">permutation</span> <span class=\"tex-span\"><i>p</i></span> is a sequence of integers <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\">1</sub>,&#x2009;<i>p</i><sub class=\"lower-index\">2</sub>,&#x2009;...,&#x2009;<i>p</i><sub class=\"lower-index\"><i>n</i></sub></span>, consisting of <span class=\"tex-span\"><i>n</i></span> distinct positive integers, each of them doesn&apos;t exceed <span class=\"tex-span\"><i>n</i></span>. The <span class=\"tex-span\"><i>i</i></span>-th element of the permutation <span class=\"tex-span\"><i>p</i></span> is denoted as <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>i</i></sub></span>. The size of the permutation <span class=\"tex-span\"><i>p</i></span> is denoted as <span class=\"tex-span\"><i>n</i></span>.</p>","sampleTestcases":[{"id":1613158250959,"input":"7\n5 2 4 3 6 7 1\n0001001\n0000000\n0000010\n1000001\n0000000\n0010000\n1001000\n","output":"1 2 4 3 6 7 5\n"},{"id":1613158250960,"input":"5\n4 2 1 5 3\n00100\n00011\n10010\n01101\n01010\n","output":"1 2 3 4 5\n"}],"submitUrl":"https://codeforces.com/problemset/submit","language":"c++"}